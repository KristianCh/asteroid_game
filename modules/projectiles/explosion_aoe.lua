function explosion_aoe_init(self)
	self.rot = 0
	
	self.update_type = explosion_aoe_update
	self.message_type = explosion_aoe_message

	self.targeted = false

	local values = { 0, 0.3, 0.21640703999999994, 0.13600032, 0.058738079999999956, -0.015421440000000033, -0.08652000000000006, -0.15459936000000005, -0.2197012800000001, -0.28186752, -0.34113984, -0.3975600000000001, -0.45116976, -0.5020108799999999, -0.55012512, -0.59555424, -0.63834, -0.67852416, -0.7161484799999999, -0.75125472, -0.78388464, -0.8140800000000002, -0.84188256, -0.8673340800000001, -0.8904763200000002, -0.91135104, -0.9299999999999999, -0.9464649599999999, -0.96078768, -0.9730099200000001, -0.9831734399999997, -0.9913199999999998, -0.9974913599999998, -1.0017292800000002, -1.0040755199999998, -1.0045718399999999, -1.0032599999999998, -1.0001817599999998, -0.9953788800000001, -0.98889312, -0.9807662400000001, -0.9710399999999998, -0.95975616, -0.9469564800000003, -0.9326827200000003, -0.9169766400000003, -0.8998800000000002, -0.8814345600000002, -0.8616820800000001, -0.8406643200000001, -0.81842304, -0.795, -0.7704369600000001, -0.7447756799999998, -0.71805792, -0.69032544, -0.6616199999999999, -0.6319833599999999, -0.6014572800000001, -0.5700835200000002, -0.5379038400000001, -0.5049600000000001, -0.4712937600000001, -0.43694688000000004, -0.40196111999999995, -0.36637823999999997, -0.3302399999999999, -0.29358816000000004, -0.2564644799999999, -0.21891071999999984, -0.18096864000000024, -0.1426800000000002, -0.1040865600000001, -0.06523008000000008, -0.026152320000000118, 0.013104959999999943, 0.05249999999999999, 0.09199104000000002, 0.13153631999999998, 0.17109408000000004, 0.21062256000000018, 0.2500800000000002, 0.28942464000000023, 0.3286147199999998, 0.3676084799999998, 0.40636415999999986, 0.4448399999999998, 0.4829942399999999, 0.52078512, 0.55817088, 0.5951097600000002, 0.63156, 0.6674798400000002, 0.7028275200000001, 0.7375612800000002, 0.7716393599999998, 0.8050199999999997, 0.83766144, 0.86952192, 0.9005596799999999, 0.9307329599999999 }
	self.easing = vmath.vector(values)

	go.set("#sprite", "tint", vmath.vector4(1, 0, 0, 1))
	sprite.play_flipbook("#sprite", "square_aoe")
end

function explosion_aoe_update(self, dt) 
	if not self.targeted then
		msg.post("/manager", "target_all_enemies", {dt = dt})
		self.targeted = true
	end
end

function explosion_aoe_message(self, message_id, message, sender)
	if message_id == hash("target_enemy_response") then
		for key, v in ipairs(message.enemies) do
			local asteroid_url = v
			local asteroid_position = go.get_position(asteroid_url)
			local vec_to_asteroid = asteroid_position - go.get_position()
			local distance = vmath.length(vec_to_asteroid) - 10 * go.get(asteroid_url, "size")
			if distance <= self.range then
				msg.post(asteroid_url, "damage_asteroid", {damage = self.damage, type = "explosive"})
			end
		end
	end
end